<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generar Reporte</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <form id="reporteForm" class="login-form">
    <h1>Formulario de Reporte</h1>

    <div class="form-input-material">
      <label for="rut">RUT</label>
      <input
        type="text"
        name="rut"
        id="rut"
        required
        autocomplete="off"
      />
    </div>

    <div class="form-input-material">
      <label for="cliente_activo">¿Es un cliente activo?</label>
      <select
        name="cliente_activo"
        id="cliente_activo"
        required
      >
        <option value="">Seleccione...</option>
        <option value="si">Sí</option>
        <option value="no">No</option>
      </select>
    </div>

    <div class="form-input-material">
      <label for="tipo_reporte">Tipo de reporte</label>
      <select
        name="tipo_reporte"
        id="tipo_reporte"
        required
      >
        <option value="ventas_todos">Ventas - Todo método de pago</option>
        <option value="ventas_efectivo">Ventas - efectivo</option>
        <option value="productos_por_venta">Detalle de item por venta</option>
        <option value="documentos_sin_modelo">Ventas + sin modelo de emisión</option>
        <option value="boletas">Boletas</option>
      </select>
    </div>

    <div class="form-input-material">
      <label for="fecha_inicio">Fecha inicio</label>
      <input
        type="date"
        name="fecha_inicio"
        id="fecha_inicio"
        required
      />
    </div>

    <div class="form-input-material">
      <label for="fecha_fin">Fecha fin</label>
      <input
        type="date"
        name="fecha_fin"
        id="fecha_fin"
        required
      />
    </div>

    <div class="form-input-material">
      <label for="correo_destinatario">Correo destinatario</label>
      <input
        type="email"
        name="correo_destinatario"
        id="correo_destinatario"
        required
        autocomplete="off"
      />
    </div>

    <button
      type="submit"
      class="btn"
    >
      Generar
    </button>

    <div id="message" style="margin-top: 16px; font-weight: bold;"></div>
  </form>

  <script>
    document.getElementById("reporteForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch("https://haulmerinc.app.n8n.cloud/webhook-test/reporte", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        document.getElementById("message").innerText = result.message || "Solicitud enviada";
      } catch (error) {
        document.getElementById("message").innerText = "Error al enviar el formulario";
      }
    });
  </script>
</body>
</html>